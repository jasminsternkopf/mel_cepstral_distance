# Mel-Cepstral Distance

[![PyPI](https://img.shields.io/pypi/v/mel-cepstral-distance.svg)](https://pypi.python.org/pypi/mel-cepstral-distance)
[![PyPI](https://img.shields.io/pypi/pyversions/mel-cepstral-distance.svg)](https://pypi.python.org/pypi/mel-cepstral-distance)
[![MIT](https://img.shields.io/github/license/jasminsternkopf/mel_cepstral_distance.svg)](https://github.com/jasminsternkopf/mel_cepstral_distance/blob/main/LICENSE)
![PyPI](https://img.shields.io/pypi/implementation/mel-cepstral-distance.svg)
[![PyPI](https://img.shields.io/github/commits-since/jasminsternkopf/mel_cepstral_distance/latest/main.svg)](https://github.com/jasminsternkopf/mel_cepstral_distance/compare/v0.0.2...main)
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.7044405.svg)](https://doi.org/10.5281/zenodo.7044405)

CLI and library to compute the mel-cepstral distance of two WAV files based on the paper ["Mel-Cepstral Distance Measure for Objective Speech Quality Assessment"](https://ieeexplore.ieee.org/document/407206) by Robert F. Kubichek.

## Installation

```sh
pip install mel-cepstral-distance --user
```

## Usage as CLI

```sh
mcd-cli
```

### Example

```sh
# Download two example audio files
wget https://github.com/jasminsternkopf/mel_cepstral_distance/raw/main/examples/similar_audios/original.wav
wget https://github.com/jasminsternkopf/mel_cepstral_distance/raw/main/examples/similar_audios/inferred.wav

# Calculate metrics
mcd-cli original.wav inferred.wav
```

Output:

```text
Mel-Cepstral Distance: 19.013673608495836
Penalty: 0.11946050096339111
# Frames: 519
```

This will print a message informing you about the mel-cepstral distance and penalty between the audios whose paths were given as arguments and the number of frames that were used in the computation.

## Usage as a library

```py
from mel_cepstral_distance import get_metrics_wavs, get_metrics_mels
```

### Methods

- `get_metrics_wavs`
- `get_metrics_mels`

Both methods return the mel-cepstral distance, the penalty and the final frame number. Examples and information on the parameters can be found in the corresponding documentations.

### Dependencies

- `librosa >= 0.9.1, < 0.1`
- `numpy >= 1.22.3, < 1.24`
- `scipy >= 1.8.0, < 1.10`
- `fastdtw >= 0.3.4, < 0.4`

## Roadmap

- add command to process audio files from two distinct directories and output the result into a csv file

## Running the tests

```sh
git clone https://github.com/jasminsternkopf/mel_cepstral_distance.git
cd mel_cepstral_distance
pip install .
pip install tox
tox
```

## Contributing

If you notice an error, please don't hesitate to open an issue.

## License

MIT License

## References

- Kubichek, R. “Mel-Cepstral Distance Measure for Objective Speech Quality Assessment.” In Proceedings of IEEE Pacific Rim Conference on Communications Computers and Signal Processing, 1:125–28. Victoria, BC, Canada: IEEE, 1993. https://doi.org/10.1109/PACRIM.1993.407206.
- Muda, Lindasalwa, Mumtaj Begam, and I. Elamvazuthi. “Voice Recognition Algorithms Using Mel Frequency Cepstral Coefficient (MFCC) and Dynamic Time Warping (DTW) Techniques.” Journal of Computing vol. 2, no. 3 (March 2010): 6.

## Acknowledgments

Funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) – Project-ID 416228727 – CRC 1410

## Citation

If you want to cite this repo, you can use this BibTeX-entry generated by GitHub (see *About => Cite this repository*).

## FAQ

### How were the default parameters set?

We based some of the parameters on the two mentioned references and set the other ones by ourselves depending on the parameter description of the underlying libraries:

- `hop-length` -> 256: Kubichek & Muda et al.
- `window` -> hamming: Muda et al.
- `n-mels` -> 20: Kubichek
- `n-mfcc` -> 16: by us
- `n-fft` -> 1024: by us
- `center` -> False: by us
- `htk` -> False: by us
- `norm` -> None: by us
- `dtw` -> True: by us

### Why is Python 3.12 not supported?

The dependency `numba` is currently not available for Python 3.12.

## Changelog

- v0.0.3 (unreleased)
  - Added:
    - Added MCD calculation for mel-spectrograms via CLI using `from-mel`
    - Added batch processing for `from-mel` via `from-mel-batch`
    - Added logging to file
  - Changed:
    - Changed usage of CLI for wav files, now via `from-wav`
    - Improved input validation for CLI
- v0.0.2 (2022-08-17)
  - Added:
    - Added missing init files
    - Added pylint
    - Added tox config
    - Added acknowledgments
  - Changed:
    - updated dependency restrictions
    - renamed some metavars
- v0.0.1 (2022-04-26)
  - Initial release
